---
title: "milestone 4"
author: "Bernadette Stadler"
date: "10/10/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(readxl)
library(janitor)
library(reshape2)
library(scales)
```

```{r read in data, include = FALSE}
mls_salaries <- read_excel("data/MLS_Salaries.xlsx") %>% clean_names()
```

```{r make ggplot data, include = FALSE}
season <- c(2013, 2014, 2015, 2016, 2017, 2018)

nwsl_salaries <- tibble(season) %>% 
  mutate(min_salary = c(6000, 6600, 6842, 7200, 15000, 15750)) %>% mutate(max_salary = c(30000, 31500, 37800, 39700, 41700, 44000))

min_max_data <- mls_salaries %>% 
  select(season, base_salary, total_compensation) %>% 
  filter(season >= 2013) %>% 
  group_by(season) %>% 
  summarize(
    min_salary = min(base_salary), 
    max_salary = max(base_salary)
    ) %>% inner_join(
      nwsl_salaries, by = "season", suffix= c("_mls","_nwsl")
      ) %>% 
  clean_names() %>% 
  melt(id = "season") %>%
  mutate(min_or_max = ifelse(
    variable %in% c("min_salary_mls", "min_salary_nwsl"), "Min", "Max")
    ) %>% 
  mutate(league = ifelse(
    variable %in% c("max_salary_nwsl","min_salary_nwsl"), "NWSL", "MLS")
    )
```

```{r make ggplot,  echo = FALSE, warning = FALSE}

min_max_data %>% select(season, value, min_or_max, league) %>% group_by(league) %>%
  ggplot() + 
  geom_col(aes(x = season, y = value, fill = min_or_max), position = "dodge") + 
  scale_fill_manual(values=c("dodgerblue4","dodgerblue")) +
  facet_wrap(~league) +
  scale_y_log10(labels = number_format(scale = 1)) +
    labs(
    title = "Major League Soccer and National Women's Soccer League Salaries",
    subtitle = "By season, 2013-2018",
    y = "Salary (in USD)",
    x = "Season", 
    caption = "Data from MLS Player's Association, USA soccer, and The Equalizer.",
    fill = "") + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5), 
        plot.subtitle = element_text(hjust = 0.5),
        plot.caption = element_text(hjust =0.5))

```